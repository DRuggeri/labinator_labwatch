<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>Labinator</title>

    <link rel="stylesheet" href="js/reveal/reset.css">
    <link rel="stylesheet" href="js/reveal/reveal.css">
    <link rel="stylesheet" href="js/reveal/theme/black.css">
	<style>
		:root {
			--r-main-font-size: 75px;
		}
		.small {
			font-size: 50px;
		}
		section {
			padding-top: 1em;
		}
		.menubar > ul {
			gap: .5em !important;
			flex-wrap: unset !important;
		}
	</style>
	<script>
		function startLab(name) {
			console.log(`starting lab ${name}`)
			const req = new XMLHttpRequest();
			req.open("GET", `/setlab?lab=${name}`, true);
			req.onload = function() {
				if (req.status == 200) {
					console.log(`lab set to ${name}`);
				} else {
					console.log(`Request failed with status ${req.status}`);
				}
			};
			req.send();
		}
		function linkThenGo(link, target) {
			console.log(`hitting ${link}`)

			const req = new XMLHttpRequest();
			req.open("GET", link, true);
			req.onload = function() {
				if (req.status == 200) {
					console.log(`headed to ${target}`);
					const slide = Reveal.getSlides().find( ( slide ) => {
						return slide.id == target;
					});
					if (slide ) {
						i = Reveal.getIndices( slide )
						Reveal.slide(i.h, i.v, i.f);
					};
				} else {
					console.log(`Request failed with status ${req.status}`);
				}
			};
			req.send();
		}
	</script>

    <!-- Theme used for syntax highlighted code -->
    <link rel="stylesheet" href="plugin/highlight/monokai.css">
</head>
	<body>
		<div class="reveal">
			<div id="menu" class="slides">
				<section id="experiments" data-name="Experiments">
					<a href="#/vms">Virtual Machines Only</a><br />
					<a href="#/physical">Bare Metal Only</a><br />
					<a href="#/vmsbms">VM and BM Combo</a><br />
					</section>
					  <section id="vms">
						<span class="small">Launch VM lab with...</span><br />
						<a href="" onclick="startLab('virtual-2')">2 VMs per host</a><br />
						<a href="" onclick="startLab('virtual-3')">3 VMs per host</a><br />
						<a href="" onclick="startLab('virtual-4')">4 VMs per host</a><br />
					  </section>
					  <section id="physical">
						<span class="small">Launch Bare Metal lab...</span><br />
						<a href="" onclick="startLab('physical')">All six nodes</a><br />
					  </section>
					  <section id="vmsbms">
						<span class="small">Launch Bare Metal control plane with...</span><br />
						<a href="" onclick="startLab('hybrid-2')">2 VMs per worker node</a><br />
						<a href="" onclick="startLab('hybrid-3')">3 VMs per worker node</a><br />
						<a href="" onclick="startLab('hybrid-4')">4 VMs per worker node</a><br />
					  </section>
				</section>
				<section id="chaos" data-name="Chaos">
					<a href="#/kill-box">Kill a Box</a><br />
					<a href="#/restart-box">Restart a Box</a><br />
					<a href="#/kill-net">Kill a Box's Network</a><br />
					<a href="#/kill-az">Kill an AZ's Network</a><br />
				</section>
					<section id="kill-box">
						<a onclick="linkThenGo('/power?action=turnoff&port=p1', 'chaos');">Kill Box 1</a><br />
						<a onclick="linkThenGo('/power?action=turnoff&port=p2', 'chaos');">Kill Box 2</a><br />
						<a onclick="linkThenGo('/power?action=turnoff&port=p3', 'chaos');">Kill Box 3</a><br />
						<a onclick="linkThenGo('/power?action=turnoff&port=p4', 'chaos');">Kill Box 4</a><br />
						<a onclick="linkThenGo('/power?action=turnoff&port=p5', 'chaos');">Kill Box 5</a><br />
						<a onclick="linkThenGo('/power?action=turnoff&port=p6', 'chaos');">Kill Box 6</a><br />
					</section>
					<section id="restart-box">
						<a href="" onclick="linkThenGo('/power?action=restart&port=p1', 'chaos');">Restart Box 1</a><br />
						<a href="" onclick="linkThenGo('/power?action=restart&port=p2', 'chaos');">Restart Box 2</a><br />
						<a href="" onclick="linkThenGo('/power?action=restart&port=p3', 'chaos');">Restart Box 3</a><br />
						<a href="" onclick="linkThenGo('/power?action=restart&port=p4', 'chaos');">Restart Box 4</a><br />
						<a href="" onclick="linkThenGo('/power?action=restart&port=p5', 'chaos');">Restart Box 5</a><br />
						<a href="" onclick="linkThenGo('/power?action=restart&port=p6', 'chaos');">Restart Box 6</a><br />
					</section>
				</section>
				<section id="observe" data-name="Observe">
					<a href="/bosshealth">Boss health</a><br />
					<a href="/k8s dashboard">Kubernetes dashboard</a><br />
				</section>
				<section id="system" data-name="System">
					<a href="/system?action=restart">Restart the Lab</a><br />
					<a href="/system?action=shutdown">Shut Down the Lab</a><br />
				</section>
			</div>
		</div>

		<script src="js/reveal/reveal.js"></script>
		<script src="js/reveal/plugin/markdown/markdown.js"></script>
		<script src="js/reveal/plugin/highlight/highlight.js"></script>
        <script src="js/reveal/plugin/simplemenu/simplemenu.js"></script>
        <script src="js/reveal/plugin/tagteam/tagteam.js"></script>
		<script>
			Reveal.initialize({
				hash: true,
				progress: false,
				viewDistance: 100,

				simplemenu: {
					flat: true,
					inherit: "previous",
					barhtml: {
						header: "<div class='menubar'><ul class='menu'></ul></div>"
					}
				},

                controls: false,
                jumpToSlide: false,
                history: false,
                keyboard: false,
                overview: false,
                touch: false,
                mouseWheel: false,

				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealMarkdown, RevealHighlight, Simplemenu, Tagteam ]
			});
		</script>
	</body>
</html>